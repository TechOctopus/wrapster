import{products}from"../data/products.js";const filterProducts=(e,t)=>{if(!e||!e.length||!t)return[];if(""===countFilters(t))return e;let r=[...e];if(t.price&&void 0!==t.price.min&&void 0!==t.price.max&&(r=r.filter((e=>e.price>=t.price.min&&e.price<=t.price.max))),t.device&&t.device.length>0&&(r=r.filter((e=>t.device.includes(e.device)))),t.collection&&t.collection.length>0&&(r=r.filter((e=>t.collection.includes(e.collection.id)))),t.sort&&t.sort.orderByPrice)switch(t.sort.orderByPrice){case"asc":r.sort(((e,t)=>e.price-t.price));break;case"desc":r.sort(((e,t)=>t.price-e.price))}return t.sort&&t.sort.orderByDevice&&"asc"===t.sort.orderByDevice&&r.sort(((e,t)=>e.device.localeCompare(t.device))),t.search&&""!==t.search.query&&(r=r.filter((e=>`${e.collection.name} ${e.collection.label} ${e.device} ${e.collection.description} ${e.price}`.toLowerCase().includes(t.search.query.toLowerCase())))),r},countFilters=e=>{let t=0;return e.device&&e.device.length>0&&(t+=e.device.length),e.collection&&e.collection.length>0&&(t+=e.collection.length),!e.price||void 0===e.price.min&&void 0===e.price.max||t++,e.sort&&(e.sort.orderByPrice||e.sort.orderByDevice)&&t++,e.search&&""!==e.search.query&&t++,t||""},showProducts=(e,t)=>{const r=filterProducts(e,t);renderMenu(r,countFilters(t))},renderMenu=(e,t)=>{document.getElementById("filters-text").innerText=`${t} Filter${1!==t?"s":""}`;const r=document.getElementById("products-container");r.innerHTML="",0===e.length?r.innerHTML=createEmptyProductsHTML():e.forEach((e=>{const t=createProductsHTML(e);r.innerHTML+=t}))},createEmptyProductsHTML=()=>'\n  <div class="h-96 w-full flex items-center justify-center col-span-full flex-col">\n      <h2 class="text-lg font-medium text-gray-900">Sorry, no products found</h2>\n      <p class="mt-1 text-sm text-gray-500">Please clear the filters to see all products</p>\n  </div>\n',createProductsHTML=e=>`\n  <div class="group relative">\n      <div class="w-full aspect-[1/1] overflow-hidden rounded-md group-hover:opacity-75 p-4 bg-gray-50">\n          <img\n              src="${e.image[0]}"\n              alt="${e.collection.name}"\n              class="object-fit w-full aspect-[1/1] object-contain object-center"\n          />\n      </div>\n      <h3 class="mt-4 text-sm text-gray-700">\n          <a href="product.html">\n              <span class="absolute inset-0"></span>\n              ${e.collection.name}\n          </a>\n      </h3>\n      <p class="mt-1 text-sm text-gray-500">${e.collection.label}</p>\n      <p class="mt-1 text-sm font-medium text-gray-900">$${e.price}</p>\n  </div>\n`,createProxiedProperty=(e,t)=>new Proxy(e,{set:(e,r,c)=>(e[r]=c,t(),!0)}),createFilterState=e=>{const t={device:createProxiedProperty([],(()=>showProducts(e,t))),price:createProxiedProperty({min:void 0,max:void 0},(()=>showProducts(e,t))),collection:createProxiedProperty([],(()=>showProducts(e,t))),sort:createProxiedProperty({orderByPrice:void 0,orderByDevice:void 0},(()=>showProducts(e,t))),search:createProxiedProperty({query:""},(()=>showProducts(e,t)))};return showProducts(e,t),t},renderFilters=()=>{let e=createFilterState(products),t=!1;const r=document.getElementById("filters-button"),c=document.getElementById("filters-menu");r.addEventListener("click",(()=>{t=!t,t?c.classList.remove("hidden"):c.classList.add("hidden")}));const i=document.getElementById("search");i.addEventListener("input",(t=>{e.search.query=t.target.value}));const o=document.getElementById("filter-form");let n=!1;const s=document.getElementById("menu-button"),d=document.getElementById("menu");s.addEventListener("click",(()=>{n=!n,n?d.classList.remove("hidden"):d.classList.add("hidden")}));const l=[document.getElementById("menu-item-0"),document.getElementById("menu-item-1"),document.getElementById("menu-item-2")],a={active:void 0};l.forEach((t=>{t.addEventListener("click",(r=>{if(a.active===r.target.id)t.className="text-gray-500 block px-4 py-2 text-sm hover:bg-indigo-100",a.active=void 0,e.sort.orderByPrice=void 0,e.sort.orderByDevice=void 0;else switch(void 0!==a.active&&l.forEach((e=>{e.className="text-gray-500 block px-4 py-2 text-sm hover:bg-indigo-100"})),a.active=r.target.id,t.className="bg-gray-100 font-medium text-gray-900 block px-4 py-2 text-sm hover:bg-gray-200",r.target.innerText){case"Lowest Price":e.sort.orderByPrice="asc";break;case"Highest Price":e.sort.orderByPrice="desc";break;case"Device":e.sort.orderByDevice="asc"}n=!1,d.classList.add("hidden")}))}));document.getElementById("price-filter").addEventListener("change",(t=>{[e.price.min,e.price.max]=t.target.value.split("-")}));document.getElementById("device-filter").addEventListener("change",(t=>{t.target.checked?e.device.push(t.target.value):e.device.splice(e.device.indexOf(t.target.value),1)}));document.getElementById("collection-filter").addEventListener("change",(t=>{t.target.checked?e.collection.push(t.target.value):e.collection.splice(e.collection.indexOf(t.target.value),1)}));document.getElementById("clear-filters").addEventListener("click",(()=>{c.classList.add("hidden"),t=!1,d.classList.add("hidden"),i.value="",n=!1,""!==countFilters(e)&&(e=createFilterState(products),o.reset(),l.forEach((e=>{e.className="text-gray-500 block px-4 py-2 text-sm hover:bg-indigo-100"})),a.active=void 0)}))};document.addEventListener("DOMContentLoaded",(()=>{renderFilters()}));
